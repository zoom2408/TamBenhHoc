<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ca lâm sàng – Tương tác (Tailwind, Blue Theme)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @media print {
      header, input, button { display: none !important; }
      main { padding: 0 !important; }
      .group { break-inside: avoid; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-blue-50 to-white">
  <header class="sticky top-0 z-10 border-b border-blue-200/70 bg-white/90 backdrop-blur">
    <div class="mx-auto flex max-w-5xl items-center justify-between gap-4 px-4 py-3">
      <div class="flex items-center gap-3">
        <div class="flex h-9 w-9 items-center justify-center rounded-xl bg-blue-600 text-white shadow">CL</div>
        <div>
          <h1 class="text-lg font-semibold text-blue-900">Ca lâm sàng – Tương tác (Tailwind, Blue theme)</h1>
          <p class="text-xs text-blue-700/80">Tìm kiếm • Mở/thu gọn • Gợi ý chẩn đoán • In PDF</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <input id="search" placeholder="Tìm theo từ khoá, triệu chứng, chẩn đoán..." class="w-64 rounded-xl border border-blue-300 bg-white px-3 py-2 text-sm text-blue-900 placeholder:text-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400" />
        <button id="printBtn" class="rounded-xl border border-blue-300 bg-blue-600 px-3 py-2 text-sm font-medium text-white shadow hover:bg-blue-700">In / Xuất PDF</button>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-5xl p-4">
    <div class="mb-4 rounded-2xl border border-blue-200 bg-blue-50 p-4 text-sm text-blue-900">
      <div class="font-semibold">Lưu ý sử dụng</div>
      <ul class="mt-1 list-disc pl-5">
        <li>Tài liệu phục vụ học tập; không thay thế chẩn đoán/điều trị lâm sàng thực tế.</li>
        <li>Dùng ô tìm kiếm để lọc theo triệu chứng (ví dụ: “ảo thanh”, “thuyết trình”).</li>
        <li>Bấm “Gợi ý chẩn đoán” để xem đáp án/định hướng phân biệt.</li>
        <li>Nút “In / Xuất PDF” dùng lệnh in trình duyệt để lưu PDF.</li>
      </ul>
    </div>

    <div id="count" class="mb-3 text-sm text-blue-800"></div>
    <div id="cards" class="grid gap-4"></div>
  </main>

  <footer class="mx-auto max-w-5xl px-4 pb-10 pt-6 text-xs text-blue-700/80">
    © 2025 – Trang tương tác học tập ca lâm sàng (Tailwind, Blue theme)
  </footer>

  <script>
    const CASES = [
      {
        id: 1,
        title: "Case 1 – Ảo thanh, tư duy bị phát hiện, kiểm soát (1 năm)",
        body: "Cả năm trời trong đầu cháu lúc nào cũng có tiếng nói chuyện, họ có thể giao tiếp với cháu, nhìn thấy những gì cháu thấy, cháu nghĩ gì là họ cũng biết trước, toàn nói những gì cháu nghĩ và có thể trò chuyện với cháu. Ví dụ như: trông thấy cái xe máy, thì người lạ nói trong đầu cháu là nó cũng nhìn thấy cái xe máy. Nó bảo cháu thấy gì nó trông i hệt như thế người lạ trong đầu có thể điều khiển được cháu, có thể xui khiến nhiều người quen nói trong đầu cháu, có tính cách, cảm xúc, tiếng nói giống hệt như những người ngoài đời, mặc dù là ảo thanh cháu có thể ngửi thấy mùi lạ, mà rõ ràng mùi đấy không gần chỗ cháu, cháu cũng hay bị ngủ gặp ác mộng, như mình bị ma bắt, rồi bị chết, nhiều lúc cháu ngủ mơ, nhưng trong tâm cháu vẫn hiểu và như bị người khác điều khiển. Trước đây khi cháu nhập viện cháu còn không điều khiển được hành vi, mặc dù cháu vẫn suy nghĩ. Đến giờ cháu vẫn nhớ hồi đó, tuy đến giờ cháu không bị như thế, nhưng cháu hay gặp trong mơ. Hãy đưa ra chẩn đoán của dạng rối loạn tâm bệnh này.",
        answer: "Chẩn đoán gợi ý: Tâm thần phân liệt (schizophrenia) với các triệu chứng thuộc nhóm Schneider I: ảo thanh bình luận/ra lệnh, cảm giác bị kiểm soát, tư duy bị phát hiện/phát thanh; kèm ảo khứu; diễn tiến mạn tính ≥ 6 tháng.",
        tags: ["ảo thanh", "kiểm soát", "tư duy bị phát hiện", "TTPL"],
      },
      {
        id: 2,
        title: "Case 2 – Ảo thanh ra lệnh tự hại (≈1 năm)",
        body: "Trường hợp của B, một bệnh nhân được điều trị tại Bệnh viện Y. Người nhà cho biết B bị như vậy gần 1 năm nay, gia đình cho đi chữa trị nhiều nơi nhưng không thấy khỏi. Trong giây phút tỉnh táo, bệnh nhân cho biết lúc nào cũng nghe thấy lời sai bảo: ‘trốn khỏi bệnh viện về nhà’, rồi ‘dùng dao đâm vào mắt’, sau đó lại ‘chặt ngón tay’. Bệnh nhân nghe theo và nhập viện với một ngón tay đứt lìa. Hãy đưa ra chẩn đoán của dạng rối loạn tâm bệnh này.",
        answer: "Chẩn đoán gợi ý: Tâm thần phân liệt (schizophrenia) ưu thế ảo thanh ra lệnh; cần đánh giá thêm nguy cơ tự/tha gây hại, loại trừ chất và bệnh lý não.",
        tags: ["ảo thanh ra lệnh", "tự hại", "TTPL"],
      },
      {
        id: 3,
        title: "Case 3 – Ảo thanh ra lệnh chặt tay, suy giảm chức năng học tập",
        body: "Cứ văng vẳng bên tai tiếng một phụ nữ yêu cầu phải chặt tay vì ‘cánh tay này vô dụng’. Hưng, 21 tuổi, sinh viên ĐH HK-TP.HCM đã chặt đứt bàn tay. Dù nối liền, tiếng nói kỳ quặc tiếp diễn. Ngoài ảo thanh, bệnh nhân hay lẩm bẩm một mình và không còn khả năng tiếp tục đi học bình thường. Hãy đưa ra chẩn đoán của dạng rối loạn tâm bệnh này.",
        answer: "Chẩn đoán gợi ý: Tâm thần phân liệt (schizophrenia) với ảo thanh ra lệnh kéo dài và suy giảm đáng kể chức năng xã hội/học tập.",
        tags: ["ảo thanh ra lệnh", "suy giảm chức năng", "TTPL"],
      },
      {
        id: 4,
        title: "Ca 4 – Tránh nơi đông người, cần ‘khu vực an toàn’",
        body: "Bệnh nhân nam 20 tuổi lo âu phải tránh tới nơi chốn đông người, đặc biệt là khi đến chỗ đông bạn bè. Cảm giác bị đe doạ ở phòng học rộng với rất đông sinh viên; vắng mặt 2 tháng, trước đó vắng ít hơn khi có bạn cùng vào lớp. Không dùng rượu/thuốc; khám thực thể bình thường. Chẩn đoán đặt ra: ám ảnh sợ khoảng trống, rối loạn lo âu lan tỏa, rối loạn hoảng loạn, rối loạn stress sau sang chấn, ám ảnh đặc biệt. Câu trả lời là ám ảnh sợ khoảng trống (agoraphobia). Mô tả: người bệnh né tránh tình huống khó thoát/không có hỗ trợ; tạo ‘khu vực an toàn’ hoặc ‘hành vi an toàn’ (đi cùng người thân, đứng gần lối thoát). Yếu tố nguy cơ: tuổi trẻ, nữ, cơn hoảng loạn/ám ảnh sợ kèm.",
        answer: "Chẩn đoán đúng: Ám ảnh sợ khoảng trống (Agoraphobia).",
        tags: ["ám ảnh sợ", "agoraphobia", "lo âu"],
      },
      {
        id: 5,
        title: "Ca 5 – Lo âu khi phải báo cáo trước đám đông",
        body: "Ng. V. A 31 tuổi, khoẻ mạnh, công chức phải họp giao ban và báo cáo định kỳ. Gần đây lo âu, bứt rứt khi sắp thuyết trình; càng sợ khi ‘cấp trên’ đông người, xuất hiện nhức đầu, chóng mặt, hồi hộp, khó ngủ. Đến gặp bác sĩ thì không lo, nhưng hôm sau đi làm là sợ; có khi rủ bạn đi cùng. Cận lâm sàng bình thường. Đã đi khám nhiều nơi, không nhớ thuốc.",
        answer: "Chẩn đoán gợi ý: Rối loạn lo âu xã hội (Social Anxiety Disorder) – dạng sợ nói trước đám đông; cần phân biệt ám ảnh sợ đặc hiệu và rối loạn hoảng loạn.",
        tags: ["lo âu xã hội", "sợ thuyết trình", "public speaking"],
      },
    ];

    const countEl = document.getElementById('count');
    const cardsEl = document.getElementById('cards');
    const searchEl = document.getElementById('search');

    const Badge = (text) => `\n      <span class=\"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-200\">${text}</span>\n    `;

    function renderCards(query = '') {
      const q = query.trim().toLowerCase();
      cardsEl.innerHTML = '';
      let visible = 0;

      CASES.forEach((c, i) => {
        const searchable = (c.title + ' ' + c.body + ' ' + c.answer).toLowerCase(); // tags intentionally excluded from search
        if (q && !searchable.includes(q)) return;
        visible++;

        const card = document.createElement('div');
        card.className = 'group rounded-2xl border border-blue-200 bg-white shadow-sm transition hover:shadow-md';

        const headerBtn = document.createElement('button');
        headerBtn.className = 'flex w-full items-start justify-between gap-4 rounded-2xl p-4 text-left';
        headerBtn.innerHTML = `
          <div>
            <div class=\"text-sm text-blue-500\">Case ${i + 1}</div>
            <h3 class=\"mt-1 text-lg font-semibold text-blue-900\">${c.title}</h3>
          </div>
          <div class=\"mt-1 shrink-0 rounded-full border border-blue-300 bg-blue-50 px-3 py-1 text-xs text-blue-700\" data-toggle-text> Mở </div>
        `;

        const content = document.createElement('div');
        content.className = 'hidden border-t border-blue-100 p-4 pt-0';
        content.innerHTML = `
          <p class=\"whitespace-pre-line rounded-xl bg-blue-50/50 p-4 leading-relaxed text-slate-800\">${c.body}</p>
          <div class=\"mt-3 flex flex-wrap gap-2\">
            <button class=\"toggle-ans rounded-xl bg-blue-600 px-3 py-2 text-sm font-medium text-white shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400\">Gợi ý chẩn đoán</button>
            <button class=\"copy-btn rounded-xl border border-blue-300 bg-white px-3 py-2 text-sm font-medium text-blue-700 hover:bg-blue-50\">Sao chép mô tả</button>
          </div>
          <div class=\"answer hidden mt-3 rounded-xl border border-blue-200 bg-blue-50 p-4 text-blue-900\">
            <div class=\"text-sm font-semibold\">Gợi ý/Đáp án</div>
            <p class=\"mt-1 text-sm leading-relaxed\">${c.answer}</p>
            <div class=\"mt-2 flex flex-wrap gap-1\">${c.tags.map(Badge).join('')}</div>
            ${c.id === 4 ? `
              <div class=\"mt-3 text-xs text-slate-700\">
                <div class=\"font-semibold text-blue-800\">Phân biệt nhanh:</div>
                <ul class=\"mt-1 list-disc pl-5\">
                  <li>RLLT (GAD): lo âu lan toả, không gắn riêng tình huống đông người.</li>
                  <li>Rối loạn hoảng loạn: cơn đột ngột, sợ tái phát; tránh né thứ phát.</li>
                  <li>Ám ảnh đặc hiệu: sợ một đối tượng/cảnh huống cụ thể, không rộng như agoraphobia.</li>
                  <li>PTSD: sau sang chấn rõ ràng, có xâm nhập/tránh né/quá kích hoạt.</li>
                </ul>
              </div>
            ` : ''}
          </div>
        `;

        // Toggle open/close card
        headerBtn.addEventListener('click', () => {
          const isHidden = content.classList.contains('hidden');
          content.classList.toggle('hidden');
          headerBtn.querySelector('[data-toggle-text]').textContent = isHidden ? 'Thu gọn' : 'Mở';
        });

        // Delegated events inside content
        content.addEventListener('click', async (e) => {
          if (e.target.classList.contains('toggle-ans')) {
            const ans = content.querySelector('.answer');
            const isHidden = ans.classList.contains('hidden');
            ans.classList.toggle('hidden');
            e.target.textContent = isHidden ? 'Ẩn chẩn đoán' : 'Gợi ý chẩn đoán';
          }
          if (e.target.classList.contains('copy-btn')) {
            try {
              await navigator.clipboard.writeText(`${c.title}\n\n${c.body}`);
              e.target.textContent = 'Đã sao chép';
              setTimeout(() => (e.target.textContent = 'Sao chép mô tả'), 1200);
            } catch (err) {
              console.error(err);
            }
          }
        });

        card.appendChild(headerBtn);
        card.appendChild(content);
        cardsEl.appendChild(card);
      });

      countEl.textContent = `Hiển thị ${visible}/${CASES.length} ca`;
    }

    // Init
    renderCards('');

    // Search
    searchEl.addEventListener('input', (e) => {
      renderCards(e.target.value || '');
    });

    // Print
    document.getElementById('printBtn').addEventListener('click', () => window.print());
  </script>
</body>
</html>
